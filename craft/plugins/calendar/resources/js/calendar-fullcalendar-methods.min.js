function renderEvent(e,a){if(e.allDay&&a.addClass("fc-event-all-day"),e.end){if(e.multiDay||e.allDay)a.addClass("fc-event-multi-day");else{a.addClass("fc-event-single-day");var n=$("<span />").addClass("fc-color-icon").css("background-color",e.backgroundColor).css("border-color",e.borderColor);$(".fc-content",a).prepend(n)}e.enabled||a.addClass("fc-event-disabled"),a.addClass("fc-color-"+e.textColor),buildEventPopup(e,a)}}function renderDay(e,a){var n=a.parents(".fc-bg:first").siblings(".fc-content-skeleton").find("thead > tr > td:eq("+a.index()+")"),t=getDayViewLink(e),r=$("<a />").attr("href",t).html(n.html());n.html(r)}function renderView(e,a){var n=new moment;if("agendaWeek"==e.name){var t=$(".fc-day-header.fc-widget-header",a);t.each(function(){var e=$(this).html(),a=e.split(" ");e=a[0]+" <span>"+a[1]+"</span>";var t=new moment($(this).data("date")),r=getDayViewLink(t),l=$("<a />").attr("href",r).html(e);n.format("YYYYMMDD")==t.format("YYYYMMDD")&&l.addClass("fc-title-today"),$(this).html(l)})}$(".fc-localeButton-button",$("#solspace-calendar")).addClass("menubtn btn"),"agendaDay"==e.name&&$("thead.fc-head",a).remove(),$solspaceCalendarSpinner||($("#solspace-calendar .fc-right").prepend('<div id="solspace-calendar-spinner" class="spinner" style="display: none;"></div>'),$solspaceCalendarSpinner=$("#solspace-calendar-spinner"))}function eventRepositioned(e,a,n,t){var r={eventId:a.id,isAllDay:a.allDay,startDate:a.start.toISOString(),endDate:a.end?a.end.toISOString():null,deltaSeconds:n.as("seconds")};r[csrfTokenName]=csrfTokenValue,$.ajax({url:Craft.getCpUrl("calendar/events/api/modify"+e),type:"post",dataType:"json",data:r,success:function(e){e.error?t():a.repeats&&$calendar.fullCalendar("refetchEvents")},error:function(){t()}})}function eventDateChange(e,a,n){eventRepositioned("Date",e,a,n)}function eventDurationChange(e,a,n){eventRepositioned("Duration",e,a,n)}function eventClick(e){window.location.href=Craft.getCpUrl("calendar/events/"+e.id)}function getDayViewLink(e){if(e.isValid()){var a=e.format("YYYY"),n=e.format("MM"),t=e.format("DD");return Craft.getCpUrl("calendar/view/day/"+a+"/"+n+"/"+t)}return""}function getEvents(e,a,n,t){$solspaceCalendarSpinner.fadeIn("fast");var r=$("ul.calendar-list"),l="*";r.length&&(l=$("input:checked",r).map(function(){return $(this).val()}).get().join());var i={dateRangeStart:e.toISOString(),dateRangeEnd:a.toISOString(),calendars:l,locale:currentLocaleId};i[csrfTokenName]=csrfTokenValue,$.ajax({url:Craft.getCpUrl("calendar/month"),data:i,type:"post",dataType:"json",success:function(e){t(e),$solspaceCalendarSpinner.fadeOut("fast")}})}function refreshMiniCalendar(e){e||(e=$calendar.fullCalendar("getDate").toISOString());var a=$("#mini-cal-wrapper");if(a.length){var n={calendars:(a.data("calendars")+"").split(","),date:e,locale:currentLocaleId};n[csrfTokenName]=csrfTokenValue,miniCalRefreshTimer&&clearTimeout(miniCalRefreshTimer),miniCalRefreshTimer=setTimeout(function(){Craft.postActionRequest("calendar/view/miniCal",n,function(e){a.empty().html(e)})},500)}}function closeAllQTips(){qTipsEnabled=!1,$("div.qtip:visible").qtip("hide")}function enableQTips(){qTipsEnabled=!0}var $solspaceCalendarSpinner=null,today=new moment,miniCalRefreshTimer=null;