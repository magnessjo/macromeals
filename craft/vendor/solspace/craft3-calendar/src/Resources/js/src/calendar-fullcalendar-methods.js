"use strict";function _defineProperty(e,n,a){return n in e?Object.defineProperty(e,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[n]=a,e}var _slicedToArray=function(){function e(e,n){var a=[],t=!0,r=!1,i=void 0;try{for(var l,o=e[Symbol.iterator]();!(t=(l=o.next()).done)&&(a.push(l.value),!n||a.length!==n);t=!0);}catch(d){r=!0,i=d}finally{try{!t&&o["return"]&&o["return"]()}finally{if(r)throw i}}return a}return function(n,a){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),$solspaceCalendar=$("#solspace-calendar"),$solspaceCalendarSpinner=null,renderEvent=function(e,n){if(e.allDay&&n.addClass("fc-event-all-day"),e.end){if(e.multiDay||e.allDay)n.addClass("fc-event-multi-day");else{n.addClass("fc-event-single-day");var a=$("<span />").addClass("fc-color-icon").css("background-color",e.backgroundColor).css("border-color",e.borderColor);$(".fc-content",n).prepend(a)}e.enabled||n.addClass("fc-event-disabled"),n.addClass("fc-color-"+e.textColor),buildEventPopup(e,n)}},today=new moment,renderDay=function(e,n){var a=n.parents(".fc-bg:first").siblings(".fc-content-skeleton").find("thead > tr > td:eq("+n.index()+")"),t=getDayViewLink(e),r=$("<a />").attr("href",t).html(a.html());a.html(r)},renderView=function(e,n){var a=new moment;if("agendaWeek"===e.name){var t=$(".fc-day-header.fc-widget-header",n);t.each(function(){var e=$(this).html(),n=e.split(" ");e=n[0]+" <span>"+n[1]+"</span>";var t=new moment($(this).data("date")),r=getDayViewLink(t),i=$("<a />").attr("href",r).html(e);a.format("YYYYMMDD")===t.format("YYYYMMDD")&&i.addClass("fc-title-today"),$(this).html(i)})}$(".fc-localeButton-button",$solspaceCalendar).addClass("menubtn btn"),"agendaDay"===e.name&&$("thead.fc-head",n).remove()},eventRepositioned=function(e,n,a,t){$.ajax({url:Craft.getCpUrl("calendar/events/api/modify-"+e),type:"post",dataType:"json",data:_defineProperty({eventId:n.id,siteId:n.site.id,isAllDay:n.allDay,startDate:n.start.toISOString(),endDate:n.end?n.end.toISOString():null,deltaSeconds:a.as("seconds")},Craft.csrfTokenName,Craft.csrfTokenValue),success:function(e){e.error?t():n.repeats&&$calendar.fullCalendar("refetchEvents")},error:function(){t()}})},eventDateChange=function(e,n,a){eventRepositioned("date",e,n,a)},eventDurationChange=function(e,n,a){eventRepositioned("duration",e,n,a)},eventClick=function(e){window.location.href=Craft.getCpUrl("calendar/events/"+e.id+"/"+e.site.handle)},getDayViewLink=function(e){if(e.isValid()){var n=e.format("YYYY"),a=e.format("MM"),t=e.format("DD");return Craft.getCpUrl("calendar/view/day/"+n+"/"+a+"/"+t)}return""},getEvents=function(e,n,a,t){getSpinner().fadeIn("fast");var r=$("ul.calendar-list"),i="*";r.length&&(i=$("input:checked",r).map(function(){return $(this).val()}).get().join());var l=$calendar.data(),o=l.currentSiteId;$.ajax({url:Craft.getCpUrl("calendar/month"),data:_defineProperty({rangeStart:e.toISOString(),rangeEnd:n.toISOString(),calendars:i,siteId:o},Craft.csrfTokenName,Craft.csrfTokenValue),type:"post",dataType:"json",success:function(e){var n=!0,a=!1,r=void 0;try{for(var i,l=e.entries()[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var o=_slicedToArray(i.value,2),d=o[0],s=o[1];s.allDay&&(e[d].end=moment(s.end).add(2,"s").utc().format())}}catch(c){a=!0,r=c}finally{try{!n&&l["return"]&&l["return"]()}finally{if(a)throw r}}t(e),getSpinner().fadeOut("fast")}})},closeAllQTips=function(){qTipsEnabled=!1,$("div.qtip:visible").qtip("hide")},enableQTips=function(){qTipsEnabled=!0},getSpinner=function(){return $solspaceCalendarSpinner||($solspaceCalendar.find(".fc-right").prepend('<div id="solspace-calendar-spinner" class="spinner" style="display: none;"></div>'),$solspaceCalendarSpinner=$("#solspace-calendar-spinner")),$solspaceCalendarSpinner};