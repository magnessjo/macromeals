"use strict";function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}$(function(){setTimeout(function(){var e=$(".event-creator"),t=$(".lightswitch",e);t.on({change:function(){var t=$(".timewrapper",e);$("input",this).val()?t.fadeOut("fast"):t.fadeIn("fast")}}),e.each(function(){var e=$(this),t=e.data(),i=t.timeInterval,a=t.eventDuration;$("ul.errors",e).empty();var n=$('input[name="startDate[date]"]',e),r=$('input[name="startDate[time]"]',e),o=$('input[name="endDate[date]"]',e),p=$('input[name="endDate[time]"]',e);r.timepicker("option","step",i),p.timepicker("option","step",i),n.datepicker("option","onSelect",function(e){o.datepicker("option","minDate",e),o.val(e)}),r.on("change",function(){var e=n.datepicker("getDate"),t=o.datepicker("getDate"),m=0;e&&t&&(m=Math.round((t-e)/864e5));var c=r.timepicker("getTime"),s=r.timepicker("getTime");if(c)if(s.setMinutes(c.getMinutes()+parseInt(a)),p.timepicker("option","durationTime",c),0===m){var u=r.timepicker("getTime");u.setMinutes(c.getMinutes()+parseInt(i)),p.timepicker("option","showDuration",!0),p.timepicker("option","minTime",u),$(this).val()&&p.timepicker("setTime",s)}else p.timepicker("option","showDuration",!1),p.timepicker("option","minTime","00:00"),$(this).val()&&p.timepicker("setTime",c)}),o.on("change",function(){r.trigger("change")});var m=$("input[name=allDay]",e),c=m.parents(".lightswitch:first");c.data("lightswitch").turnOff(),$(".timewrapper",e).show(),$(".btn.submit",e).bind("click",function(t){var i,a=$("input[name=title]",e).val(),c=$("select[name=calendarId]",e).val(),s=moment(n.datepicker("getDate")),u=moment(r.timepicker("getTime")),l=moment(o.datepicker("getDate")),d=moment(p.timepicker("getTime")),f=m.val(),v=s.format("YYYY-MM-DD"),k=l.format("YYYY-MM-DD");return f||(v=v+" "+u.format("HH:mm:ss"),k=k+" "+d.format("HH:mm:ss")),$(".spinner",e).removeClass("hidden"),$.ajax({url:Craft.getCpUrl("calendar/events/api/create"),type:"post",dataType:"json",data:(i={startDate:v,endDate:k,allDay:f},_defineProperty(i,Craft.csrfTokenName,Craft.csrfTokenValue),_defineProperty(i,"event",{title:a,calendarId:c}),i),success:function(t){$(".spinner",e).addClass("hidden"),t.error?($("ul.errors",e).empty().append($("<li />",{text:t.error})),Craft.cp.displayError(Craft.t("calendar","Couldnâ€™t save event."))):t.event&&($("ul.errors",e).empty(),$("input[type=text]",e).val(""),Craft.cp.displayNotice(Craft.t("calendar","Event saved.")))},error:function(e){alert(e)}}),!1})})},200)});